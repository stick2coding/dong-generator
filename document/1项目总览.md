## 项目介绍
定制化的代码生成项目

### 阶段目标

#### 1、本地化代码生成器

> 代码生成器的核心就是：参数+模板=代码

问题:现在有一个a.java的文件，里面有一些代码，现在要求将里面的一些内容替换为其他内容，需要怎么做？

- 要知道哪些地方需要被替换
- 要知道应该替换为什么

此时，如果需要替换的内容比较少，可以手动进行替换，硬编码出一个新文件

如果要替换的比较多，或者以后还要多次不同的替换需求，应该如何做？

我们可以创建一张替换内容表，左边是需要替换的内容，右边是要替换为什么，然后写一个工具类，遍历源文件，逐个对替换表中的配置进行实现。

新的问题：如果有更复杂的需求，比如控制某段代码是否生成？

当需求变多，简单的工具类可能就无法满足使用了。
此时，我们可以借助模板引擎来帮助我们完成代码生成这件事情
通过模板引擎，我们将原来的文件模板化，将要替换的内容参数化，然后通过输入的参数，调用模板引擎，由引擎帮我们实现内容替换

问题：要替换成什么如何存储和传递给引擎？
可以通过使用json文件来存储，通过读取文件获取参数

问题：当原始文件目录复杂，文件多的时候怎么做？
我们将文件分为两类，
一类是静态文件，在代码生成时不需要替换任何内容，直接复制即可
另一类是动态文件，需要使用模板引擎进行内容替换
我们在生成时，将动态文件单独提取出来，单独处理，其余文件直接复制即可

问题：如何工具化？

当我们引入模板引擎，实现该功能后，如果另一个人需要使用，我们就要把全部代码拷贝给他，不够便捷。
这时，我们可以通过maven将代码打包为jar包。
分享后，需要使用的人准备好配置，然后在控制台执行jar包即可。

问题：如何更加便捷？
准备json文件存储参数对不懂这块的人是比较麻烦的。且json文件本身也无法说明各个参数都是干什么用。
这里我们可以通过执行jar，在后面拼接命令来传递参数。
但是这样，仍然不了解参数的含义，而且控制台写执行命令也很复杂。
这时候，我们可以参考终端里面的命令，可以通过在终端里面引导用户逐步输入各种参数，最后执行时将用户的参数传递给服务进行生成。

这里我们可以借助picocli来完成命令行的开发。

最后，我们只需要将脚本和jar打包分享出去。用户通过执行脚本，就可以与服务进行简单的交互，按照引导输入参数，完成代码生成。

#### 2、制作工具

上一步，我们实现了一个给定一组文件，为它写了一个代码生成器，支持通过输入参数来生成指定的代码
那么，如果是另外一个文件，我们就要重新开发一个代码生成器，来实现支持这个文件要输入的参数以及内容替换。
那么是否可以根据一些配置，来自动生成对应的代码生成器呢？

通过分析我们前面写的代码生成器，有几点值得注意：
1、首先是文件的分类，就是说静态文件和动态文件的处理要分开，如果需要自动生成，就需要知道具体的分类。
2、参数，就是需要替换的位置和内容是什么

 我们可以定义一个配置文件，用来描述一个文件的分类，以及需要替换的位置和内容。我们将这个文件成为meta.json

这个时候就是要求程序能够根据meta.json的配置来生成对应的生成器代码。
这里的需求和第一阶段的需求就比较相似了。我们可以使用模板引擎，将我们已经写好的代码生成器改造成一个通用模板，支持通过读取meta.json生成对应的代码

进而，我们还需要将参数生成对应的命令，便于以后分享给其他人可以直接通过命令行来使用。

最后，当代码生成完成，还需要程序能够自动打包程序，自动生成执行脚本。

具体开发过程的优化内容可查看编程导航学习教程。

注意事项：

- 程序要支持通过参数控制文件是否生成
- 一个参数要能控制多个文件的生成
- 参数能够分组
- 参数组可以支持是否开启

#### 3、模板制作

当文件比较少的时候，我们可以手动制作模板，那文件比较多的时候还是手动就比较耗时了，这时就要支持自动制作。

和代码生成器的区别是，要替换的内容不一样。前面是 a.java.ftl 到 a.java 现在是 a.java 到 a.java.ftl

同理，要知道哪些文件需要制作成模板，文件里面哪些内容需要被替换。

一个大项目的目录结构是比较复杂的。我们是需要根据需求逐步对所有文件进行替换
那么一是要支持追加替换，就是下一次的替换要在原来的基础上做
二是每次遍历项目目录时，要知道这一次需要替换哪些文件，支持文件过滤

然后，制作完模板后，我们还要根据制作时替换的内容自动生成meta.json文件，也就是将需要替换的内容配置化
方便后续直接使用，而不是到时候再根据需求手写meta.json文件

#### 在线平台开发







